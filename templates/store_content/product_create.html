{% extends 'base.html' %}

{% block title %}
<title>Create Product</title>
{% endblock %}

{% block content %}
<h2>Create Product</h2>
<form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">Create Product</button>
</form>
<script>
    document.getElementById('region_id').addEventListener('change', function () {
        const regionId = this.value;
        const citySelect = document.getElementById('id_city');
        citySelect.innerHTML = '<option value="">--- Select a city ---</option>';
        if (regionId) {
            fetch(`cities/?region_id=${regionId}`)
            .then(response => {
                if (!response.ok) {
                    throw new Error('Failed to fetch cities');
                }
                return response.json();
            })
                .then(data => {
                    data.forEach(city => {
                        const option = document.createElement('option');
                        option.value = city.id;
                        option.textContent = city.name;
                        citySelect.appendChild(option);
                    });
                });
        }
    });
</script>
{% endblock %}